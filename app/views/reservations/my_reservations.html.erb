<% content_for :title, "My Reservations" %>

<div class="card mb-6">
  <h1 class="card-title mb-6">My Reservations</h1>
</div>

<!-- Active Reservations -->
<% if @active_reservations.any? %>
  <div class="card mb-6">
    <h2 style="font-size: 1.25rem; font-weight: 600; color: #1f2937; margin-bottom: 1rem; display: flex; align-items: center;">
      <i class="fas fa-play" style="color: #27ae60; margin-right: 0.5rem;"></i>
      Active Reservations
    </h2>
    
    <div class="space-y-4">
      <% @active_reservations.each do |reservation| %>
        <div class="reservation-card active">
          <div style="display: flex; justify-content: space-between; align-items: flex-start;">
            <div>
              <h3 style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;"><%= reservation.car.display_name %></h3>
              <p style="font-size: 0.875rem; color: #6b7280;">
                <i class="fas fa-calendar" style="margin-right: 0.25rem;"></i>
                <%= reservation.start_date.strftime("%B %d, %Y") %> - <%= reservation.end_date.strftime("%B %d, %Y") %>
              </p>
              <p style="font-size: 0.875rem; color: #6b7280;">
                <i class="fas fa-clock" style="margin-right: 0.25rem;"></i>
                <%= pluralize(reservation.duration_days, 'day') %> remaining
              </p>
            </div>
            <div class="text-right">
              <div style="font-size: 1.125rem; font-weight: 700; color: #27ae60;">
                <%= number_to_currency(reservation.final_amount_after_discount) %>
              </div>
              <% if reservation.admin_discount? %>
                <div style="font-size: 0.75rem; color: #27ae60; margin-top: 0.25rem;">
                  <i class="fas fa-tag" style="margin-right: 0.25rem;"></i>20% Admin Discount
                </div>
              <% end %>
              <%= link_to reservation_path(reservation), style: "font-size: 0.875rem; color: #2563eb; text-decoration: none;" do %>
                <i class="fas fa-eye" style="margin-right: 0.25rem;"></i>View Details
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% end %>

<!-- Upcoming Reservations -->
<% if @upcoming_reservations.any? %>
  <div class="card mb-6">
    <h2 style="font-size: 1.25rem; font-weight: 600; color: #1f2937; margin-bottom: 1rem; display: flex; align-items: center;">
      <i class="fas fa-clock" style="color: #2563eb; margin-right: 0.5rem;"></i>
      Upcoming Reservations
    </h2>
    
    <div class="space-y-4">
      <% @upcoming_reservations.each do |reservation| %>
        <div class="reservation-card upcoming">
          <div style="display: flex; justify-content: space-between; align-items: flex-start;">
            <div>
              <h3 style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;"><%= reservation.car.display_name %></h3>
              <p style="font-size: 0.875rem; color: #6b7280;">
                <i class="fas fa-calendar" style="margin-right: 0.25rem;"></i>
                <%= reservation.start_date.strftime("%B %d, %Y") %> - <%= reservation.end_date.strftime("%B %d, %Y") %>
              </p>
              <p style="font-size: 0.875rem; color: #6b7280;">
                <i class="fas fa-hourglass-half" style="margin-right: 0.25rem;"></i>
                Starts in <%= pluralize((reservation.start_date - Date.current).to_i, 'day') %>
              </p>
            </div>
            <div class="text-right">
              <div style="font-size: 1.125rem; font-weight: 700; color: #2563eb;">
                <%= number_to_currency(reservation.final_amount_after_discount) %>
              </div>
              <% if reservation.admin_discount? %>
                <div style="font-size: 0.75rem; color: #27ae60; margin-top: 0.25rem;">
                  <i class="fas fa-tag" style="margin-right: 0.25rem;"></i>20% Admin Discount
                </div>
              <% end %>
              <div class="flex gap-2" style="margin-top: 0.5rem;">
                <%= link_to reservation_path(reservation), style: "font-size: 0.875rem; color: #2563eb; text-decoration: none;" do %>
                  <i class="fas fa-eye" style="margin-right: 0.25rem;"></i>View
                <% end %>
                <%= link_to cancel_reservation_path(reservation), 
                    data: { confirm: "Are you sure you want to cancel this reservation?" },
                    style: "font-size: 0.875rem; color: #dc2626; text-decoration: none;" do %>
                  <i class="fas fa-times" style="margin-right: 0.25rem;"></i>Cancel
                <% end %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% end %>

<!-- Past Reservations -->
<% if @past_reservations.any? %>
  <div class="card mb-6">
    <h2 style="font-size: 1.25rem; font-weight: 600; color: #1f2937; margin-bottom: 1rem; display: flex; align-items: center;">
      <i class="fas fa-check" style="color: #6b7280; margin-right: 0.5rem;"></i>
      Past Reservations
    </h2>
    
    <div class="space-y-4">
      <% @past_reservations.each do |reservation| %>
        <div class="reservation-card past">
          <div style="display: flex; justify-content: space-between; align-items: flex-start;">
            <div>
              <h3 style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;"><%= reservation.car.display_name %></h3>
              <p style="font-size: 0.875rem; color: #6b7280;">
                <i class="fas fa-calendar" style="margin-right: 0.25rem;"></i>
                <%= reservation.start_date.strftime("%B %d, %Y") %> - <%= reservation.end_date.strftime("%B %d, %Y") %>
              </p>
              <p style="font-size: 0.875rem; color: #6b7280;">
                <i class="fas fa-history" style="margin-right: 0.25rem;"></i>
                Completed <%= time_ago_in_words(reservation.end_date) %> ago
              </p>
            </div>
            <div class="text-right">
              <div style="font-size: 1.125rem; font-weight: 700; color: #6b7280;">
                <%= number_to_currency(reservation.final_amount_after_discount) %>
              </div>
              <% if reservation.admin_discount? %>
                <div style="font-size: 0.75rem; color: #27ae60; margin-top: 0.25rem;">
                  <i class="fas fa-tag" style="margin-right: 0.25rem;"></i>20% Admin Discount
                </div>
              <% end %>
              <%= link_to reservation_path(reservation), style: "font-size: 0.875rem; color: #6b7280; text-decoration: none;" do %>
                <i class="fas fa-eye" style="margin-right: 0.25rem;"></i>View Details
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% end %>

<!-- Empty State -->
<% if @active_reservations.empty? && @upcoming_reservations.empty? && @past_reservations.empty? %>
  <div class="text-center" style="padding: 3rem 0;">
    <i class="fas fa-calendar-times" style="font-size: 4rem; color: #d1d5db; margin-bottom: 1rem;"></i>
    <h3 style="font-size: 1.25rem; font-weight: 600; color: #6b7280; margin-bottom: 0.5rem;">No reservations yet</h3>
    <p style="color: #9ca3af; margin-bottom: 1rem;">Start by browsing our available cars and making your first reservation.</p>
    <%= link_to cars_path, class: "btn btn-primary" do %>
      <i class="fas fa-car" style="margin-right: 0.5rem;"></i>Browse Available Cars
    <% end %>
  </div>
<% end %> 