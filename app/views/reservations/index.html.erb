<% content_for :title, "My Reservations" %>

<div class="card mb-6">
  <h1 class="card-title mb-6">My Reservations</h1>
  
  <div class="flex gap-4 mb-6">
    <%= link_to "All Reservations", reservations_path, 
        class: "btn #{params[:filter].blank? ? 'btn-primary' : 'btn-secondary'}" %>
    <%= link_to "Active", reservations_path(filter: 'active'), 
        class: "btn #{params[:filter] == 'active' ? 'btn-primary' : 'btn-secondary'}" %>
    <%= link_to "Upcoming", reservations_path(filter: 'upcoming'), 
        class: "btn #{params[:filter] == 'upcoming' ? 'btn-primary' : 'btn-secondary'}" %>
    <%= link_to "Past", reservations_path(filter: 'past'), 
        class: "btn #{params[:filter] == 'past' ? 'btn-primary' : 'btn-secondary'}" %>
  </div>
</div>

<div class="space-y-4">
  <% @reservations.each do |reservation| %>
    <div class="reservation-card">
      <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
        <div>
          <h3 style="font-size: 1.25rem; font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">
            <%= reservation.car.display_name %>
          </h3>
          <p style="color: #6b7280;">
            <i class="fas fa-calendar" style="margin-right: 0.5rem;"></i>
            <%= reservation.start_date.strftime("%B %d, %Y") %> - <%= reservation.end_date.strftime("%B %d, %Y") %>
          </p>
        </div>
        
        <div class="text-right">
          <div style="font-size: 1.5rem; font-weight: 700; color: #2563eb;">
            <%= number_to_currency(reservation.total_price) %>
          </div>
          <div style="font-size: 0.875rem; color: #6b7280;">
            <%= reservation.duration_days %> day<%= reservation.duration_days > 1 ? 's' : '' %>
          </div>
        </div>
      </div>
      
      <div style="display: flex; align-items: center; justify-content: space-between;">
        <div style="display: flex; align-items: center; gap: 1rem;">
          <span class="car-type-badge <%= reservation.car.car_type %>">
            <%= reservation.car.car_type.titleize %>
          </span>
          
          <% if reservation.is_completed? %>
            <span class="status-badge completed">
              <i class="fas fa-check" style="margin-right: 0.25rem;"></i>Completed
            </span>
          <% elsif reservation.is_active? %>
            <span class="status-badge active">
              <i class="fas fa-play" style="margin-right: 0.25rem;"></i>Active
            </span>
          <% elsif reservation.is_upcoming? %>
            <span class="status-badge upcoming">
              <i class="fas fa-clock" style="margin-right: 0.25rem;"></i>Upcoming
            </span>
          <% else %>
            <span class="status-badge completed">
              <i class="fas fa-check" style="margin-right: 0.25rem;"></i>Completed
            </span>
          <% end %>
        </div>
        
        <div class="flex gap-2">
          <%= link_to reservation_path(reservation), class: "btn btn-primary" do %>
            <i class="fas fa-eye" style="margin-right: 0.25rem;"></i>View
          <% end %>
          
          <% if reservation.is_upcoming? %>
            <%= link_to cancel_reservation_path(reservation), 
                data: { confirm: "Are you sure you want to cancel this reservation?" },
                class: "btn btn-danger" do %>
              <i class="fas fa-times" style="margin-right: 0.25rem;"></i>Cancel
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>

<% if @reservations.empty? %>
  <div class="text-center" style="padding: 3rem 0;">
    <i class="fas fa-calendar-times" style="font-size: 4rem; color: #d1d5db; margin-bottom: 1rem;"></i>
    <h3 style="font-size: 1.25rem; font-weight: 600; color: #6b7280; margin-bottom: 0.5rem;">No reservations found</h3>
    <p style="color: #9ca3af; margin-bottom: 1rem;">
      <% if params[:filter].present? %>
        No <%= params[:filter] %> reservations.
      <% else %>
        You haven't made any reservations yet.
      <% end %>
    </p>
    <%= link_to cars_path, class: "btn btn-primary" do %>
      <i class="fas fa-car" style="margin-right: 0.5rem;"></i>Browse Available Cars
    <% end %>
  </div>
<% end %>
